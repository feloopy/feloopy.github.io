<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <!-- Keep zooming available for users on mobile (do NOT set maximum-scale or disable zoom). -->
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Become a Pro FelooPy User</title>

  <link href="https://fonts.googleapis.com/css2?family=Chakra+Petch:wght@400;600;700&family=Vazirmatn:wght@300;400;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" />

  <style>
  :root{
    --bg-1: #f9fafb;
    --bg-2: #eef2f6;
    --card: #ffffff;
    --muted: #6b7280;
    --text: #0f172a;
    --green-500: #28a745;
    --blue-600: #3d3d3d;
    --max-width: 1200px;
    --radius-lg: 14px;
    --space: 20px;
    --base: 16px;
    --shadow-1: 0 8px 30px rgba(8,15,25,0.06);
    --shadow-2: 0 18px 40px rgba(8,15,25,0.08);
  }

  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0;
    font-family: Inter, "Vazirmatn", system-ui, -apple-system, "Segoe UI", Roboto, Arial;
    font-size:var(--base);
    color:var(--text);
    background: linear-gradient(180deg,var(--bg-1),var(--bg-2));
    -webkit-font-smoothing:antialiased;

    /* center horizontally, but let vertical positioning change with viewport size */
    display:flex;
    align-items:flex-start; /* default to top-aligned to avoid cutoffs on small screens */
    justify-content:center;
    padding:28px;
    min-height:100vh;
    overflow-y:auto;
  }

  /* On larger viewports, vertically center the content for nicer layout */
  @media (min-width: 769px) {
    body { align-items:center; }
  }

  .stage{
    width:100%;
    max-width:var(--max-width);
    display:grid;
    gap:var(--space);
    grid-template-columns: 1fr;
    align-items:start;
  }

  /* HERO */
  .hero {
    display: grid;
    grid-template-columns: 1fr auto 1fr; /* left title, logo, right title */
    align-items: center;
    gap: 40px;
    background: linear-gradient(180deg, rgba(255,255,255,0.96), rgba(255,255,255,0.94));
    border-radius: var(--radius-lg);
    padding: 32px 40px;
    box-shadow: var(--shadow-1);
    position: relative;
    overflow: hidden;
    border: 1px solid rgba(0,0,0,0.03);
  }

  .hero::before {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 4px;
    background: linear-gradient(90deg, var(--blue-600), var(--green-500));
  }

  .title-block {
    display: flex;
    flex-direction: column;
    gap: 4px;
    min-width: 0; 
  }

  .title-block-en, .title-block-fa { text-align: left; }

  .logo-container {
    display: flex;
    justify-content: center;
    padding: 5px;
  }

  .logo{ 
    width: 80px; 
    height: auto; 
    display: block;
    max-width: 100%;
  }

  .main-title{
    font-family: 'Chakra Petch', sans-serif;
    font-size: clamp(22px, 3.8vw, 36px);
    font-weight: 800;
    margin: 0;
    background: linear-gradient(45deg, #3b3b3c, #3b3b3c);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    letter-spacing: -0.01em;
    line-height: 1.2;
  }

  .main-title.fa {
    font-family: 'Vazirmatn', sans-serif;
    font-weight: 800;
    letter-spacing: -0.015em;
    line-height: 1.3;
  }

  .subtitle{ 
    margin:0; 
    color:#8cbe5f; 
    font-weight:500; 
    font-size:1.05rem;
    letter-spacing: -0.01em;
  }

  /* Cards */
  .grid-panels{ 
    display:grid; 
    grid-template-columns: 1fr 1fr; 
    gap:24px;
  }

  .card{ 
    background:var(--card); 
    border-radius:var(--radius-lg); 
    padding:20px; 
    box-shadow: var(--shadow-1); 
    transition: all 0.3s ease; 
    display:flex; 
    flex-direction:column; 
    gap:18px;
    border: 1px solid rgba(0,0,0,0.03);
    position: relative;
    overflow: hidden;
  }

  .card::before {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 4px;
    background: linear-gradient(90deg, var(--blue-600), #3d3d3d);
  }

  .card:nth-child(2)::before {
    background: linear-gradient(90deg, var(--green-500), #169243);
  }

  /* Glowing Hover */
  .card:hover{ 
    transform: translateY(-8px); 
  }

  #english:hover {
    box-shadow: var(--shadow-2), 0 0 20px 4px rgba(61, 61, 61, 0.6);
  }
  #persian:hover {
    box-shadow: var(--shadow-2), 0 0 20px 4px rgba(40, 167, 69, 0.6);
  }

  .panel-head{ 
    display:flex; 
    gap:10px; 
    align-items:center;
    padding-top: 28px;
  }

  .panel-icon{ 
    width:60px; 
    height:60px; 
    border-radius:14px; 
    display:inline-grid; 
    place-items:center; 
    background: linear-gradient(135deg, rgba(59,130,246,0.1), rgba(59,130,246,0.05));
    flex-shrink:0;
    font-size: 24px;
    color: var(--blue-600);
  }

  #persian .panel-icon {
    background: linear-gradient(135deg, rgba(16,185,129,0.1), rgba(16,185,129,0.05));
    color: var(--green-500);
  }

  /* Fix: avoid extreme negative letter-spacing for panel titles to stop rendering issues */
  .panel-title{ 
    margin:0; 
    font-size:1.25rem; 
    font-weight:700;
    letter-spacing: -0.02em; /* mild tightening only */
    font-family: 'Chakra Petch', system-ui, -apple-system, "Segoe UI", Roboto, Arial;
  }

  /* Persian card title should use Persian-friendly font */
  #persian .panel-title { font-family: 'Vazirmatn', sans-serif; letter-spacing: -0.01em; }

  .panel-desc{ 
    margin:0; 
    color:var(--muted); 
    font-size:1.02rem;
    line-height: 1.5;
  }

  .cta{ 
    display:inline-flex; 
    align-items:center; 
    gap:12px; 
    padding:14px 22px; 
    border-radius:10px; 
    font-weight:700; 
    font-size:1.05rem; 
    text-decoration:none; 
    color:white; 
    justify-content:center; 
    min-width:220px; 
    box-shadow: 0 10px 26px rgba(8,15,25,0.08); 
    transition: all 0.2s ease; 
    border: none;
    cursor: pointer;
    position: relative;
    overflow: hidden;
  }

  .cta::after {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, rgba(255,255,255,0.1), rgba(255,255,255,0.2));
    z-index: -1;
    transform: translateX(-100%);
    transition: transform 0.3s ease;
  }

  .cta:hover::after { transform: translateX(0); }
  .cta:active{ transform: translateY(1px) scale(0.98); }
  .cta:focus{ outline:4px solid rgba(2,132,199,0.14); outline-offset:3px; border-radius:12px }
  .cta i{ font-size:1.15rem; transition: transform 0.2s ease; }
  .cta:hover i { transform: translateX(3px); }
  .cta-local{ background: linear-gradient(90deg, var(--green-500), #169243); }
  .cta-intl{ background: linear-gradient(90deg, var(--blue-600), #3d3d3d); }

  .meta { color: var(--muted); font-size: 0.95rem; line-height: 1.6; margin-top: 4px; }
  .rtl{ direction:rtl; text-align:right; font-family:"Vazirmatn", "Chakra Petch", sans-serif; }

  .badge {
    position: absolute;
    top: 20px;
    right: 20px;
    background: #f1cd48;
    color: #3d3d3d;
    padding: 6px 14px;
    border-radius: 4px;
    font-size: 0.85rem;
    font-weight: 700;
    box-shadow: 0 4px 12px rgba(139,92,246,0.25);
  }
  .rtl .badge { right: auto; left: 20px; }

  .main-title,
  .main-title.fa,
  .subtitle {
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  /* helper class used by JS to hide content on small screens while keeping it available to screen readers when desired */
  .is-hidden-mobile { display:none !important; }

  /* small screens responsive rules */
  @media (max-width:1000px){ 
    .grid-panels{ grid-template-columns: 1fr; }
    .logo{ width: 120px; }
    .title-block-en, .title-block-fa { text-align: center; }
    .hero { grid-template-columns: 1fr; }
    .hero { padding: 24px; gap: 20px; }
  }

  @media (max-width: 768px) {
    body { padding: 16px; }
    .card { padding: 18px; }
    .panel-head { padding-top: 28px; }

    /* shrink CTA so it fits nicely on narrow screens */
    .cta { min-width: 140px; padding: 12px 14px; font-size: 0.95rem; }

    /* move badges in a bit to avoid overflow */
    .badge { top: 12px; right: 12px; padding: 6px 10px; font-size: 0.8rem; }
    .rtl .badge { left: 12px; right: auto; }
  }

  /* Very small screens safe-guards */
  @media (max-width: 420px) {
    .main-title { font-size: clamp(20px, 6vw, 30px); }
    .subtitle { font-size: 0.95rem; }
    .panel-title { font-size: 1.05rem; }
  }

  </style>
</head>
<body>
<main class="stage" role="main" aria-label="Become a Pro User — FelooPy">

  <header class="hero" role="banner">
    <!-- English title block (visible on desktop; JS will control mobile visibility) -->
    <div class="title-block title-block-en" id="title-en">
      <h1 class="main-title">Become a Pro FelooPy User!</h1>
      <p class="subtitle">Go from x to x*!</p>
    </div>

    <div class="logo-container" aria-hidden="true">
      <!-- keep image responsive; replace the src with your real asset path -->
      <img src="assets/images/logo-pro.png" alt="FelooPy logo" class="logo" />
    </div>

    <!-- Persian title block (visible on desktop; JS will control mobile visibility) -->
    <div class="title-block title-block-fa rtl" id="title-fa" lang="fa" dir="rtl">
      <h1 class="main-title fa">کاربر حرفه‌ای فلوپای شوید!</h1>
      <p class="subtitle">از x به x* بروید!</p>
    </div>
  </header>

  <section class="grid-panels" aria-label="Registration options">
    <article id="english" class="card" lang="en">
      <div class="panel-head">
        <div class="panel-icon" aria-hidden="true"><i class="fa-solid fa-globe"></i></div>
        <div>
          <h2 class="panel-title">English Registration</h2>
          <p class="panel-desc">Only cryptocurrency payments are accepted.</p>
        </div>
      </div>
      <div class="meta">Please ensure all information is accurate and complete.</div>
      <div class="badge" aria-hidden="true">Get pro features</div>
      <div style="display:flex; gap:12px; margin-top:auto; justify-content:flex-end;">
        <a id="cta-en" class="cta cta-intl" href="#" target="_blank" rel="noopener noreferrer" aria-label="Open English registration form" hreflang="en" data-lang="en">
          <i class="fa-solid fa-globe" aria-hidden="true"></i><span>Register Now</span>
        </a>
      </div>
    </article>

    <article id="persian" class="card rtl" lang="fa" dir="rtl">
      <div class="panel-head">
        <div class="panel-icon" aria-hidden="true"><i class="fa-solid fa-home"></i></div>
        <div>
          <h2 class="panel-title">ثبت نام فارسی</h2>
          <p class="panel-desc">پرداخت با تمامی روش‌های داخلی و رمزارزهای معتبر امکان‌پذیر است.</p>
        </div>
      </div>
      <p class="meta rtl">لطفاً اطلاعات خود را کاملاً با دقت وارد نمایید.</p>
      <div class="badge rtl" aria-hidden="true">دریافت ویژگی‌های حرفه‌ای</div>
      <div style="display:flex; gap:12px; margin-top:auto; justify-content:flex-end;">
        <a id="cta-fa" class="cta cta-local" href="#" target="_blank" rel="noopener noreferrer" aria-label="باز کردن فرم ثبت‌نام فارسی" lang="fa" dir="rtl" hreflang="fa" data-lang="fa">
          <i class="fa-solid fa-home" aria-hidden="true"></i><span>ثبت نام کنید</span>
        </a>
      </div>
    </article>
  </section>
</main>

<script>
  /* Public form URLs */
  const FORMS = {
    en: "https://forms.gle/AgQ7tztwciraRXSE9",
    fa: "https://forms.gle/2cQ48WW1D8JVZ4Ls8"
  };

  function setFormLinks() {
    const enAnchor = document.querySelector('#cta-en');
    const faAnchor = document.querySelector('#cta-fa');
    if (enAnchor && FORMS.en) {
      enAnchor.href = FORMS.en;
    }
    if (faAnchor && FORMS.fa) {
      faAnchor.href = FORMS.fa;
    }
  }

  // Detect country by IP using a public geolocation API with a short timeout.
  // NOTE: this sends the client's IP to the chosen provider. You can replace the endpoint
  // with your own server-side lookup if you prefer not to call a third-party service from the browser.
  async function detectCountryCode(timeoutMs = 2500) {
    // Try a list of fallback providers for resilience (some may be rate-limited).
    const providers = [
      'https://ipapi.co/json/',      // returns { country: 'IR', country_name: 'Iran', ... }
      'https://ipwhois.app/json/',   // returns { country_code: 'IR', ... }
      'https://ipinfo.io/json?token=' // you may add a token if you have one; without token CORS may fail
    ];

    for (const url of providers) {
      try {
        const controller = new AbortController();
        const id = setTimeout(() => controller.abort(), timeoutMs);
        const res = await fetch(url, { signal: controller.signal });
        clearTimeout(id);
        if (!res.ok) throw new Error('non-ok');
        const json = await res.json();
        // Normalize possible fields
        const code = (json.country || json.country_code || json.countryCode || json.countryCodeISO2 || '').toString().toUpperCase();
        if (code) return code;
      } catch (e) {
        // try next provider silently
        // console.debug('geo provider failed', url, e);
      }
    }
    return null; // unknown
  }

  async function applyMobileVisibility() {
    const params = new URLSearchParams(window.location.search);
    const forcedLang = (params.get('lang') || '').toLowerCase(); // allow ?lang=fa or ?lang=en to force

    const preferFa = (navigator.language || navigator.userLanguage || '').toLowerCase().startsWith('fa');

    const enBlock = document.getElementById('title-en');
    const faBlock = document.getElementById('title-fa');

    // On narrow screens we want only one title to be visible to avoid vertical overflow.
    const isNarrow = window.matchMedia('(max-width: 768px)').matches;

    if (!isNarrow) {
      // On wider screens show both
      enBlock.classList.remove('is-hidden-mobile');
      faBlock.classList.remove('is-hidden-mobile');
      enBlock.setAttribute('aria-hidden', 'false');
      faBlock.setAttribute('aria-hidden', 'false');
      return;
    }

    // If ?lang= is provided it takes precedence
    if (forcedLang === 'fa') {
      enBlock.classList.add('is-hidden-mobile');
      faBlock.classList.remove('is-hidden-mobile');
      enBlock.setAttribute('aria-hidden', 'true');
      faBlock.setAttribute('aria-hidden', 'false');
      return;
    }
    if (forcedLang === 'en') {
      faBlock.classList.add('is-hidden-mobile');
      enBlock.classList.remove('is-hidden-mobile');
      faBlock.setAttribute('aria-hidden', 'true');
      enBlock.setAttribute('aria-hidden', 'false');
      return;
    }

    // Otherwise: attempt IP geolocation. If request fails, fallback to browser language.
    let country = null;
    try {
      country = await detectCountryCode(2500);
    } catch (e) {
      country = null;
    }

    // If inside Iran (country code 'IR') => show Persian. Else show English.
    const insideIran = country === 'IR';
    if (insideIran) {
      enBlock.classList.add('is-hidden-mobile');
      faBlock.classList.remove('is-hidden-mobile');
      enBlock.setAttribute('aria-hidden', 'true');
      faBlock.setAttribute('aria-hidden', 'false');
    } else {
      // fallback: if detection failed, use browser preference (preferFa), otherwise default to English
      if (country === null) {
        if (preferFa) {
          enBlock.classList.add('is-hidden-mobile');
          faBlock.classList.remove('is-hidden-mobile');
          enBlock.setAttribute('aria-hidden', 'true');
          faBlock.setAttribute('aria-hidden', 'false');
        } else {
          faBlock.classList.add('is-hidden-mobile');
          enBlock.classList.remove('is-hidden-mobile');
          faBlock.setAttribute('aria-hidden', 'true');
          enBlock.setAttribute('aria-hidden', 'false');
        }
      } else {
        // detected outside Iran
        faBlock.classList.add('is-hidden-mobile');
        enBlock.classList.remove('is-hidden-mobile');
        faBlock.setAttribute('aria-hidden', 'true');
        enBlock.setAttribute('aria-hidden', 'false');
      }
    }
  }

  document.addEventListener('DOMContentLoaded', () => {
    setFormLinks();
    applyMobileVisibility();

    // Re-apply if orientation or width changes (user rotates phone)
    window.addEventListener('resize', () => applyMobileVisibility());

    // Optional: quick keyboard + accessibility enhancement — allow Enter on focused CTA anchors
    document.querySelectorAll('.cta').forEach(a => {
      a.addEventListener('keydown', (e) => {
        if (e.key === 'Enter') { a.click(); }
      });
    });
  });

  // Public helper in case other scripts want to open a form programmatically
  function openForm(lang) {
    const url = FORMS[lang];
    if (!url) return console.warn('Form URL not set for:', lang);
    window.open(url, '_blank', 'noopener');
  }
</script>

</body>
</html>